# 輸出格式參考

本文件提供 implementation.md 和 acceptance.feature 的詳細格式範例。

## 任務清單 (implementation.md)

生成的任務清單**必須**遵循以下結構：

```markdown
# 實作計畫

## 來源文件參考

<!-- 根據實際情況填寫，至少需要 PRD 或 Research 其中之一 -->
**PRD 文件路徑：** `[PRD 檔案的相對路徑，如無則省略此行]`
**研究文件路徑：** `[Research 檔案的相對路徑，如無則省略此行]`

## 任務概要

- [ ] 任務標題 1
- [ ] 任務標題 2
- [ ] 任務標題 3
- [ ] 任務標題 4
- [ ] 執行驗收測試
- [ ] 更新專案文件

## 任務細節

### 任務標題 1

**實作要點**
- 實作要點描述
- 實作要點描述
- 實作要點描述

**相關檔案**
- `path/to/file1.ts` - 簡要說明此檔案為何相關
- `path/to/file2.test.ts` - 測試檔案

**完成檢查**
- 檢查要點描述一
- 檢查要點描述二（共 1-5 條，使用純條列，不使用 checkbox）

**實作備註**
<!-- 生成時留空。執行任務後填寫：重大偏離、技術決策、障礙、需傳遞的上下文 -->

---

### 執行驗收測試

**實作要點**
- 使用 AI 讀取 acceptance.feature 檔案
- 透過指令或 MCP 瀏覽器操作執行每個場景
- 驗證所有場景通過並記錄結果
- 如發現問題，記錄詳細的錯誤資訊和重現步驟

**相關檔案**
- `acceptance.feature` - Gherkin 格式的驗收測試場景
- `acceptance-report.md` - 詳細的驗收測試執行報告（執行時生成）

**實作備註**
<!-- 生成時留空 -->

---

### 更新專案文件

**實作要點**
- 審查 README.md，根據新功能更新使用說明和功能清單
- 審查 CLAUDE.md，更新專案架構和技術考量說明
- 審查其他專案層級文件（如 API 文件、部署指南、貢獻指南等）
- 注意文件長度控制：適時摘要舊內容，抽象化技術細節
- 確保所有程式碼範例和指令都是最新且可執行的
- **注意**：不需要更新 docs/research 和 docs/specs 目錄中的歷史文件

**相關檔案**
- `README.md` - 專案主要說明文件
- `CLAUDE.md` - AI 助手的專案指引文件
- 其他專案層級的 `.md` 文件（根據實際需求識別）

**實作備註**
<!-- 生成時留空 -->

---

## 實作參考資訊

<!-- 根據來源文件類型調整章節，至少包含一個來源 -->

### 來自研究文件的技術洞察
> **文件路徑：** `[研究文件路徑]`
<!-- 如無研究文件則省略此章節 -->

- [提取的技術洞察和實作方法]
- [程式碼範例和實作模式]
- [已驗證的解決方案]

### 來自 PRD 的實作細節
> **文件路徑：** `[PRD 文件路徑]`
<!-- 如無 PRD 則省略此章節 -->

- [技術架構決策和理由]
- [具體的 API 設計或檔案結構]
- [PRD 中提到的實作範例]
- [技術限制和考量事項]

### 關鍵技術決策
- [總結關鍵技術選擇和其依據]
- [重要的實作細節和注意事項]
```

## 驗收條件檔案 (acceptance.feature)

Gherkin 格式的驗收條件**必須**遵循以下結構：

```gherkin
# language: zh-TW
功能: [功能名稱]
  作為 [使用者角色]
  我想要 [功能目標]
  以便 [商業價值]

  背景:
    假設 [系統初始狀態]
    並且 [額外的前置條件]

  場景: [場景名稱 - 對應 PRD 中的一個驗收條件]
    假設 [前置條件]
    當 [使用者執行的動作]
    那麼 [預期結果]
    並且 [額外的驗證]

  場景: [另一個場景名稱]
    假設 [前置條件]
    當 [使用者執行的動作]
    那麼 [預期結果]

  場景大綱: [參數化的場景]
    假設 用戶輸入 "<input>"
    當 系統處理輸入
    那麼 應該返回 "<output>"

    例子:
      | input | output |
      | 值1   | 結果1  |
      | 值2   | 結果2  |
```

## 驗收測試執行說明

驗收測試由 AI 直接執行：讀取 acceptance.feature 場景 → 轉換為指令或瀏覽器操作 → 執行並驗證 → 報告結果（包含預期之外的情況或警告）

## 任務格式說明

### 雙層結構設計

implementation.md 採用「任務概要 + 任務細節」的雙層結構：

- **任務概要**：簡潔的 checkbox 列表，用於快速瀏覽和 TodoWrite 同步
- **任務細節**：每個任務的完整章節，包含實作要點、相關檔案、完成檢查、實作備註
- **關鍵原則**：標題必須完全一致，不使用編號

### 任務細節結構

每個任務包含四個固定子區塊：

- **實作要點**：具體的實作步驟（條列式）
- **相關檔案**：該任務需要修改的檔案清單（每個任務獨立，不使用全域區塊）
- **完成檢查**：1-5 條簡要的檢查要點，說明如何確認該任務已完成（使用純條列 `-`，不使用 checkbox `- [ ]`）
- **實作備註**：**生成時留空**，僅保留 HTML 註解提示；執行任務時才填寫上下文記錄

**注意**：「執行驗收測試」和「更新專案文件」兩個固定任務不包含「完成檢查」章節。

### 任務標題原則

- 使用描述性標題，避免編號（如「建立檔案掃描和路由生成工具」而非「任務 1」）
- 概要和細節的標題必須完全一致

### 實作備註填寫指引

**重要：生成 implementation.md 時，實作備註必須留空（僅保留 HTML 註解提示）。以下指引是給執行任務的開發者參考的。**

- **必須記錄**：與原始計畫的重大偏離、關鍵技術決策、技術障礙、需要後續任務注意的依賴
- **不需記錄**：照預期完成的實作（可標註「照預期開發」或留空）、過於細節的程式碼變更、可從其他文件取得的資訊
- **記錄原則**：只記錄下一個任務或對話框需要知道、但無法從現有文件得到的上下文
